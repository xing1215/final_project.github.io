---
title: "zz2603"
author: "Ziyi Zhao"
date: "12/3/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

```

# Win rate for each hero across years

```{r, fig.width=20,fig.height=18}
matchinfo = read_csv("./data/matchinfo.csv") %>% 
  janitor::clean_names()

btopchamp = pull(matchinfo,blue_top_champ) %>% as_tibble()
colnames(btopchamp) = "blue_top_champ"  

bresult = pull(merge_file,b_result) %>% as_tibble()
colnames(bresult) = "b_result"

year = pull(merge_file,year) %>% as_tibble()
colnames(year) = "year"

bherowin = bind_cols(year,bresult,btopchamp) %>%
  mutate(blue_top_champ = factor(blue_top_champ),
         year = factor(year),
         year = relevel(year,"2015")) %>% 
  group_by(blue_top_champ) %>% 
  mutate(total=n()) %>% 
  filter(b_result=="win") %>% 
  mutate(nwin=n(),
         win_rate = nwin/total) %>% 
  ungroup(blue_top_champ) %>% 
  mutate(
    blue_top_champ = fct_reorder(blue_top_champ,win_rate,.desc=FALSE)) %>% 
  ggplot(aes(x=blue_top_champ,y=win_rate,fill=blue_top_champ))+
  geom_bar(stat="identity")+
  labs(
    x="Hero",
    y="Win Rate",
    title = "Number of top champion in blue team")+
  theme(axis.text.x = element_text(angle = 90,hjust=1),
        axis.title = element_text(size = 25,face = "bold"),
        axis.text = element_text(size=15),
        plot.title = element_text(size=26,face = "bold"))+
  coord_flip()+
  viridis::scale_fill_viridis(discrete = TRUE)+
  facet_grid(.~year)

```

# Every Hero Pick Rate across years

```{r}




```

# The rate of Hero being banned across years

```{r}

```






